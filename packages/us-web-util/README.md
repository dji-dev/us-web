# @dji-dev/us-web-util

Runtime utilities for US Web Team at DJI.

## Installing

`yarn add @dji-dev/us-web-util`

Using `yarn` is highly recommended but not required.

# License

    Copyright 2020 DJI Technology LLC.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the "Software"),
    to deal in the Software without restriction, including without limitation
    the rights to use, copy, modify, merge, publish, distribute, sublicense,
    and/or sell copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [createSVGViewBox](#createsvgviewbox)
    -   [Parameters](#parameters)
-   [requestUserLocation](#requestuserlocation)
-   [compareFunc](#comparefunc)
    -   [Parameters](#parameters-1)
-   [constrain](#constrain)
    -   [Parameters](#parameters-2)
-   [injectScript](#injectscript)
    -   [Parameters](#parameters-3)
-   [getIsJest](#getisjest)
-   [isScrolledToBottom](#isscrolledtobottom)
    -   [Parameters](#parameters-4)
-   [jsonClone](#jsonclone)
    -   [Parameters](#parameters-5)
-   [hasScrollBar](#hasscrollbar)
    -   [Parameters](#parameters-6)
-   [roundFixed](#roundfixed)
    -   [Parameters](#parameters-7)
-   [getAllStyles](#getallstyles)
-   [getRootHostname](#getroothostname)
    -   [Parameters](#parameters-8)
-   [isMobileSafari](#ismobilesafari)
-   [invariant](#invariant)
    -   [Parameters](#parameters-9)
-   [resolveTimeout](#resolvetimeout)
    -   [Parameters](#parameters-10)
-   [resolveIdleCallback](#resolveidlecallback)

## createSVGViewBox

[packages/us-web-util/lib/svg.ts:5-7](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/svg.ts#L5-L7 "Source code on GitHub")

Small factory function to create an SVG viewbox for {@param width} and
{@param height}.

### Parameters

-   `width` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `height` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## requestUserLocation

[packages/us-web-util/lib/dom.ts:12-33](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L12-L33 "Source code on GitHub")

Requests current user's location.

<https://developers.google.com/web/fundamentals/native-hardware/user-location/>

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;LngLat>** 

## compareFunc

[packages/us-web-util/lib/index.ts:22-32](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L22-L32 "Source code on GitHub")

For use with Array#sort as the default comparator converts to
strings beforehand.

Reference:
<https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort>

### Parameters

-   `a` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `b` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **CompareResult** 

## constrain

[packages/us-web-util/lib/index.ts:40-50](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L40-L50 "Source code on GitHub")

Constrains a number between {@param min} and {@param max}.

### Parameters

-   `a` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `min` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `max` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** 

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## injectScript

[packages/us-web-util/lib/dom.ts:41-52](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L41-L52 "Source code on GitHub")

Injects a JS script into the <head> tag.

### Parameters

-   `src` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** JS file URL.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** Promise that resolves when the script is loaded.

## getIsJest

[packages/us-web-util/lib/index.ts:56-58](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L56-L58 "Source code on GitHub")

In some cases, it is useful at runtime to know if
we're inside of a Jest environment.

## isScrolledToBottom

[packages/us-web-util/lib/dom.ts:58-64](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L58-L64 "Source code on GitHub")

Returns true if {@param el} is scrolled to the bottom,
within {@param threshold}.

### Parameters

-   `el` **[Element](https://developer.mozilla.org/docs/Web/API/Element)** 
-   `threshold`   (optional, default `0`)

## jsonClone

[packages/us-web-util/lib/index.ts:63-65](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L63-L65 "Source code on GitHub")

Using JSON.parse and JSON.stringify to clone a JS object.

### Parameters

-   `obj` **T** 

Returns **T** 

## hasScrollBar

[packages/us-web-util/lib/dom.ts:70-72](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L70-L72 "Source code on GitHub")

Returns true if {@param el}'s scroll height is larger
than the client height.

### Parameters

-   `el` **[Element](https://developer.mozilla.org/docs/Web/API/Element)** 

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

## roundFixed

[packages/us-web-util/lib/index.ts:72-76](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L72-L76 "Source code on GitHub")

Rounds a number to a fixed set of decimal places.

### Parameters

-   `a` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `places` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `0`)
-   `base` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `BASE_10`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## getAllStyles

[packages/us-web-util/lib/dom.ts:80-87](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L80-L87 "Source code on GitHub")

Returns a full stylesheet for the application.

This will include CSS Modules from Vue or React w/ proper Webpack
config.

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## getRootHostname

[packages/us-web-util/lib/index.ts:83-91](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L83-L91 "Source code on GitHub")

Removes any subdomains from the host.

Example: abc.google.com -> google.com

### Parameters

-   `hostname` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `baseParts` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `2`)

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## isMobileSafari

[packages/us-web-util/lib/dom.ts:96-103](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/dom.ts#L96-L103 "Source code on GitHub")

If we're on 'vanilla' Mobile Safari. Will not be true
for Chrome for iOS.

Modified from this analysis of different user-agents:
<https://stackoverflow.com/posts/29696509/revisions>

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

## invariant

[packages/us-web-util/lib/index.ts:96-104](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L96-L104 "Source code on GitHub")

Simple implementation of the invariant pattern (used by Facebook).

### Parameters

-   `condition` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 
-   `message` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## resolveTimeout

[packages/us-web-util/lib/index.ts:109-111](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L109-L111 "Source code on GitHub")

Resolves the Promise after {@param duration}.

### Parameters

-   `duration` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `0`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

## resolveIdleCallback

[packages/us-web-util/lib/index.ts:116-122](https://github.com/dji-dev/us-web/blob/e831baa47ef290fb0f35196c09ad6b54cc67e239/packages/us-web-util/lib/index.ts#L116-L122 "Source code on GitHub")

Resolve on next idle callback.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 
